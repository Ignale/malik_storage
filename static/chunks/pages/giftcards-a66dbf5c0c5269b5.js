(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[685],{3670:function(e,t,n){"use strict";var r=n(9499),a=n(3179),i=n(4038),l=n(1039),o=n(5944);t.Z=function(e){var t=e.children;return(0,o.BX)(u,{children:[(0,o.tZ)(i.Z,{}),(0,o.tZ)(d,{children:t})]})};var u=(0,a.Z)("div",{target:"e105wq4n1"})({name:"7whenc",styles:"display:flex;width:100%"}),d=(0,a.Z)("div",{target:"e105wq4n0"})((0,r.Z)({width:"100vw",height:"100vh",overflowY:"scroll",paddingRight:"20px",paddingLeft:"20px"},l.H.tablet,{width:"100vw",paddingBottom:"12vh"}),"")},803:function(e,t,n){"use strict";n.r(t),n.d(t,{__N_SSP:function(){return S},default:function(){return C}});var r=n(3670),a=n(6687),i=n(29),l=n(7794),o=n.n(l),u=n(2896),d=n(8650),c=n(4334),s=n(2527),f=n(1202),v=n(6094),h=n(4182),g=n(7294),m=n(9403),p=n(4420),w=n(5944),y=[{name:"Использован",label:"used"},{name:"Активен",label:"active"}],Z=[{field:"code",header:"Код карты"},{field:"giver",header:"ФИО дарителя, тел"},{field:"reciever",header:"ФИО получателя, тел"},{field:"amount",header:"Сумма сертификата"},{field:"date",header:"Дата"},{field:"manager",header:"Менеджер "},{field:"status",header:"Статус"}];function b(e,t){return _.apply(this,arguments)}function _(){return(_=(0,i.Z)(o().mark(function e(t,n){var r,a;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r={method:"POST",body:JSON.stringify(n.arg)},e.prev=2,e.next=5,fetch(t,r);case 5:if(!(a=e.sent).ok){e.next=8;break}return e.abrupt("return",a.json());case 8:e.next=14;break;case 10:throw e.prev=10,e.t0=e.catch(2),console.log(e.t0),e.t0;case 14:case"end":return e.stop()}},e,null,[[2,10]])}))).apply(this,arguments)}var k=function(e){var t=e.sertificates,n=(0,g.useState)(function(){return t}),r=n[0],i=n[1],l=(0,g.useRef)(null),o=(0,c.Z)("/api/mutateSert",b,{onError:function(e){console.log(e),l.current.show({severity:"error",summary:"Ошибка",detail:e.message,life:3e3})},onSuccess:function(e){l.current.show({severity:"success",summary:"Успешно",detail:"Карта добавлена",life:3e3})},revalidate:!0}).trigger,_=function(e){var t;return console.log(e),null===(t=y.find(function(t){return t.label===e.status}))||void 0===t?void 0:t.name};return(0,w.BX)("div",{className:"card p-fluid",children:[(0,w.tZ)(p.F,{ref:l}),(0,w.BX)(u.w,{value:r,editMode:"row",tableStyle:{minWidth:"50rem"},onRowEditComplete:function(e){var t=(0,a.Z)(r),n=e.newData,l=e.index;console.log(e),t[l]=n,t[l].status=n.status,o(t),i(t)},children:[Z.map(function(e){var t=e.field,n=e.header;return(0,w.tZ)(d.s,{field:t,header:n,style:{width:"25%"},body:"status"===t&&_,editor:function(e){var t;return"amount"===(t=e).field?(0,w.tZ)(h.R,{value:t.value,onValueChange:function(e){var n;return null===(n=t.editorCallback)||void 0===n?void 0:n.call(t,e.value)},mode:"currency",currency:"RUB"}):"date"===t.field?(0,w.tZ)(s.f,{dateFormat:"dd.mm.yyyy",value:t.value,onChange:function(e){var n,r=new Date(e.target.value),a=r.toLocaleString("default",{year:"numeric"}),i=r.toLocaleString("default",{month:"2-digit"}),l=[r.toLocaleString("default",{day:"2-digit"}),i,a].join(".");return null===(n=t.editorCallback)||void 0===n?void 0:n.call(t,l)}}):"status"===t.field?(console.log(t),(0,w.tZ)(f.L,{value:y.find(function(e){return e.label===t.value}),onChange:function(e){var n;return null===(n=t.editorCallback)||void 0===n?void 0:n.call(t,e.target.value.label)},options:y,optionLabel:"name"})):(0,w.tZ)(v.o,{type:"text",value:t.value,onChange:function(e){var n;return null===(n=t.editorCallback)||void 0===n?void 0:n.call(t,e.target.value)}})}},t)}),(0,w.tZ)(d.s,{rowEditor:!0,headerStyle:{width:"10%",minWidth:"8rem"},bodyStyle:{textAlign:"center"}})]}),(0,w.tZ)(m.z,{onClick:function(){i(function(e){return[].concat((0,a.Z)(e),[{amount:0,code:"",date:"",giver:"",reciever:"",manager:"",status:""}])})},className:"mt-5",icon:"pi pi-plus",rounded:!0,"aria-label":"Filter"})]})},S=!0;function C(e){var t=e.sertificates;return(0,w.tZ)(r.Z,{children:(0,w.tZ)(k,{sertificates:t})})}},2830:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/giftcards",function(){return n(803)}])}},function(e){e.O(0,[257,916,567,635,527,38,774,888,179],function(){return e(e.s=2830)}),_N_E=e.O()}]);